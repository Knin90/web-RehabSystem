# ðŸ”„ DIAGRAMAS DE SECUENCIA - Sistema de RehabilitaciÃ³n

## ðŸ“‘ ÃNDICE DE DIAGRAMAS

1. [AutenticaciÃ³n de Usuario](#1-autenticaciÃ³n-de-usuario)
2. [Crear y Asignar Rutina (Terapeuta)](#2-crear-y-asignar-rutina-terapeuta)
3. [Realizar SesiÃ³n de Terapia con Captura (Terapeuta)](#3-realizar-sesiÃ³n-de-terapia-con-captura-terapeuta)
4. [Compartir Video con Paciente (Terapeuta)](#4-compartir-video-con-paciente-terapeuta)
5. [Ver y Realizar Rutina (Paciente)](#5-ver-y-realizar-rutina-paciente)
6. [Capturar y Compartir Video (Paciente)](#6-capturar-y-compartir-video-paciente)
7. [Gestionar Usuarios (Administrador)](#7-gestionar-usuarios-administrador)
8. [Configurar Sistema (Administrador)](#8-configurar-sistema-administrador)
9. [Exportar Datos (Administrador)](#9-exportar-datos-administrador)
10. [Ver Videos Compartidos](#10-ver-videos-compartidos)

---

## 1. AUTENTICACIÃ“N DE USUARIO

```
Usuario          Sistema Web         Flask Routes      Base de Datos
  â”‚                   â”‚                    â”‚                 â”‚
  â”‚â”€â”€GET /loginâ”€â”€â”€â”€â”€â”€>â”‚                    â”‚                 â”‚
  â”‚                   â”‚                    â”‚                 â”‚
  â”‚<â”€â”€Formularioâ”€â”€â”€â”€â”€â”€â”‚                    â”‚                 â”‚
  â”‚   Login           â”‚                    â”‚                 â”‚
  â”‚                   â”‚                    â”‚                 â”‚
  â”‚â”€â”€POST /loginâ”€â”€â”€â”€â”€>â”‚                    â”‚                 â”‚
  â”‚  (usuario, pass)  â”‚                    â”‚                 â”‚
  â”‚                   â”‚â”€â”€login()â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
  â”‚                   â”‚                    â”‚                 â”‚
  â”‚                   â”‚                    â”‚â”€â”€Query Userâ”€â”€â”€â”€>â”‚
  â”‚                   â”‚                    â”‚  (username)     â”‚
  â”‚                   â”‚                    â”‚                 â”‚
  â”‚                   â”‚                    â”‚<â”€â”€User Dataâ”€â”€â”€â”€â”€â”‚
  â”‚                   â”‚                    â”‚                 â”‚
  â”‚                   â”‚                    â”‚â”€â”€Verify Passâ”€â”€â”€>â”‚
  â”‚                   â”‚                    â”‚  (bcrypt)       â”‚
  â”‚                   â”‚                    â”‚                 â”‚
  â”‚                   â”‚                    â”‚<â”€â”€Validâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                   â”‚                    â”‚                 â”‚
  â”‚                   â”‚                    â”‚â”€â”€login_user()â”€â”€â”€â”‚
  â”‚                   â”‚                    â”‚  (Flask-Login)  â”‚
  â”‚                   â”‚                    â”‚                 â”‚
  â”‚                   â”‚<â”€â”€Redirectâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
  â”‚                   â”‚   (dashboard)      â”‚                 â”‚
  â”‚                   â”‚                    â”‚                 â”‚
  â”‚<â”€â”€Dashboardâ”€â”€â”€â”€â”€â”€â”€â”‚                    â”‚                 â”‚
  â”‚   (segÃºn rol)     â”‚                    â”‚                 â”‚
```


---

## 2. CREAR Y ASIGNAR RUTINA (TERAPEUTA)

```
Terapeuta      Sistema Web      Flask Routes      Base de Datos
  â”‚                 â”‚                 â”‚                 â”‚
  â”‚â”€â”€GET /therapist/routinesâ”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
  â”‚                 â”‚                 â”‚                 â”‚
  â”‚                 â”‚                 â”‚â”€â”€Queryâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                 â”‚                 â”‚  Routines       â”‚
  â”‚                 â”‚                 â”‚  Exercises      â”‚
  â”‚                 â”‚                 â”‚  Patients       â”‚
  â”‚                 â”‚                 â”‚                 â”‚
  â”‚                 â”‚                 â”‚<â”€â”€Dataâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                 â”‚                 â”‚                 â”‚
  â”‚<â”€â”€PÃ¡gina Rutinasâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
  â”‚                 â”‚                 â”‚                 â”‚
  â”‚â”€â”€Crear Nueva Rutinaâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
  â”‚  (nombre, ejercicios, config)     â”‚                 â”‚
  â”‚                 â”‚                 â”‚                 â”‚
  â”‚                 â”‚â”€â”€create_routine()â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                 â”‚                 â”‚                 â”‚
  â”‚                 â”‚                 â”‚â”€â”€INSERT Routineâ”€>â”‚
  â”‚                 â”‚                 â”‚                 â”‚
  â”‚                 â”‚                 â”‚<â”€â”€routine_idâ”€â”€â”€â”€â”‚
  â”‚                 â”‚                 â”‚                 â”‚
  â”‚                 â”‚                 â”‚â”€â”€INSERTâ”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                 â”‚                 â”‚  RoutineExerciseâ”‚
  â”‚                 â”‚                 â”‚  (por cada      â”‚
  â”‚                 â”‚                 â”‚   ejercicio)    â”‚
  â”‚                 â”‚                 â”‚                 â”‚
  â”‚                 â”‚                 â”‚<â”€â”€Successâ”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                 â”‚                 â”‚                 â”‚
  â”‚<â”€â”€ConfirmaciÃ³nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
  â”‚   "Rutina creada"                 â”‚                 â”‚
  â”‚                 â”‚                 â”‚                 â”‚
  â”‚â”€â”€Asignar a Pacienteâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
  â”‚  (routine_id, patient_id)         â”‚                 â”‚
  â”‚                 â”‚                 â”‚                 â”‚
  â”‚                 â”‚â”€â”€assign_routine()â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                 â”‚                 â”‚                 â”‚
  â”‚                 â”‚                 â”‚â”€â”€Queryâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                 â”‚                 â”‚  Routine        â”‚
  â”‚                 â”‚                 â”‚  Original       â”‚
  â”‚                 â”‚                 â”‚                 â”‚
  â”‚                 â”‚                 â”‚<â”€â”€Routine Dataâ”€â”€â”‚
  â”‚                 â”‚                 â”‚                 â”‚
  â”‚                 â”‚                 â”‚â”€â”€INSERTâ”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                 â”‚                 â”‚  Nueva Rutina   â”‚
  â”‚                 â”‚                 â”‚  (copia para    â”‚
  â”‚                 â”‚                 â”‚   paciente)     â”‚
  â”‚                 â”‚                 â”‚                 â”‚
  â”‚                 â”‚                 â”‚â”€â”€INSERTâ”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚                 â”‚                 â”‚  RoutineExerciseâ”‚
  â”‚                 â”‚                 â”‚  (copiar todos) â”‚
  â”‚                 â”‚                 â”‚                 â”‚
  â”‚                 â”‚                 â”‚<â”€â”€Successâ”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚                 â”‚                 â”‚                 â”‚
  â”‚<â”€â”€ConfirmaciÃ³nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                 â”‚
  â”‚   "Rutina asignada"               â”‚                 â”‚
```

---

## 3. REALIZAR SESIÃ“N DE TERAPIA CON CAPTURA (TERAPEUTA)

```
Terapeuta    Sistema Web    Flask Routes    Base de Datos    Sistema Archivos
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚â”€â”€GET /therapist/start-sessionâ”€>â”‚              â”‚                 â”‚
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚<â”€â”€PÃ¡gina SesiÃ³nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚                 â”‚
  â”‚   (con cÃ¡mara)â”‚               â”‚                â”‚                 â”‚
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚â”€â”€Seleccionar Pacienteâ”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚                 â”‚
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚â”€â”€Iniciar CÃ¡maraâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚                 â”‚
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚<â”€â”€Stream Videoâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚                 â”‚
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚â”€â”€Capturar Fotoâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚                 â”‚
  â”‚  (imagen base64)              â”‚                â”‚                 â”‚
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚              â”‚â”€â”€save_snapshot()â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚              â”‚               â”‚â”€â”€Decode base64â”€>â”‚                 â”‚
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚              â”‚               â”‚â”€â”€Save Fileâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚  (static/uploads/photos/)        â”‚
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚              â”‚               â”‚<â”€â”€File Pathâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚              â”‚               â”‚â”€â”€INSERTâ”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
  â”‚              â”‚               â”‚  SessionCaptureâ”‚                 â”‚
  â”‚              â”‚               â”‚  (tipo: photo) â”‚                 â”‚
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚              â”‚               â”‚<â”€â”€capture_idâ”€â”€â”€â”‚                 â”‚
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚<â”€â”€ConfirmaciÃ³nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚                 â”‚
  â”‚   "Foto guardada"             â”‚                â”‚                 â”‚
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚â”€â”€Grabar Videoâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚                 â”‚
  â”‚  (iniciar)   â”‚               â”‚                â”‚                 â”‚
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚<â”€â”€Grabando...â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚                 â”‚
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚â”€â”€Detener GrabaciÃ³nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚                 â”‚
  â”‚  (video blob)â”‚               â”‚                â”‚                 â”‚
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚              â”‚â”€â”€save_video_permanent()â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚              â”‚               â”‚â”€â”€Save Fileâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚  (static/uploads/videos_        â”‚
  â”‚              â”‚               â”‚   permanentes/)â”‚                 â”‚
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚              â”‚               â”‚<â”€â”€File Pathâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚              â”‚               â”‚â”€â”€INSERTâ”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
  â”‚              â”‚               â”‚  SessionCaptureâ”‚                 â”‚
  â”‚              â”‚               â”‚  (tipo: video, â”‚                 â”‚
  â”‚              â”‚               â”‚   permanente,  â”‚                 â”‚
  â”‚              â”‚               â”‚   con audio)   â”‚                 â”‚
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚              â”‚               â”‚<â”€â”€capture_idâ”€â”€â”€â”‚                 â”‚
  â”‚              â”‚               â”‚                â”‚                 â”‚
  â”‚<â”€â”€ConfirmaciÃ³nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚                 â”‚
  â”‚   "Video guardado"            â”‚                â”‚                 â”‚
```

---

## 4. COMPARTIR VIDEO CON PACIENTE (TERAPEUTA)

```
Terapeuta    Sistema Web    Flask Routes    Base de Datos
  â”‚              â”‚               â”‚                â”‚
  â”‚â”€â”€GET /therapist/video-galleryâ”€>â”‚              â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚â”€â”€get_captures()â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚â”€â”€Queryâ”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚  SessionCaptureâ”‚
  â”‚              â”‚               â”‚  (terapeuta)   â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚<â”€â”€Capturesâ”€â”€â”€â”€â”€â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚<â”€â”€GalerÃ­a Videosâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚â”€â”€Seleccionar Videoâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚
  â”‚â”€â”€Seleccionar Pacienteâ”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚
  â”‚â”€â”€Agregar Mensajeâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚
  â”‚â”€â”€Compartirâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚â”€â”€share_video()â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚â”€â”€Verifyâ”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚  Capture       â”‚
  â”‚              â”‚               â”‚  Ownership     â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚â”€â”€Verifyâ”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚  Patient       â”‚
  â”‚              â”‚               â”‚  Assignment    â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚â”€â”€INSERTâ”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚  VideoShare    â”‚
  â”‚              â”‚               â”‚  (capture_id,  â”‚
  â”‚              â”‚               â”‚   patient_id,  â”‚
  â”‚              â”‚               â”‚   mensaje)     â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚<â”€â”€share_idâ”€â”€â”€â”€â”€â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚<â”€â”€ConfirmaciÃ³nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚
  â”‚   "Video compartido"          â”‚                â”‚
```


---

## 5. VER Y REALIZAR RUTINA (PACIENTE)

```
Paciente     Sistema Web    Flask Routes    Base de Datos
  â”‚              â”‚               â”‚                â”‚
  â”‚â”€â”€GET /patient/routinesâ”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚â”€â”€patient_routines()â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚â”€â”€Query Patientâ”€>â”‚
  â”‚              â”‚               â”‚  (id_usuario)  â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚<â”€â”€Patient Dataâ”€â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚â”€â”€Queryâ”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚  Routines      â”‚
  â”‚              â”‚               â”‚  (id_paciente) â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚<â”€â”€Routinesâ”€â”€â”€â”€â”€â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚<â”€â”€Lista Rutinasâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚â”€â”€Ver Detalles Rutinaâ”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚
  â”‚  (routine_id)â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚â”€â”€get_routine_details()â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚â”€â”€Queryâ”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚  Routine       â”‚
  â”‚              â”‚               â”‚  RoutineExerciseâ”‚
  â”‚              â”‚               â”‚  Exercise      â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚<â”€â”€Full Dataâ”€â”€â”€â”€â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚<â”€â”€Detalles Rutinaâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚
  â”‚   (ejercicios, series,        â”‚                â”‚
  â”‚    repeticiones, descanso)    â”‚                â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚â”€â”€Iniciar Rutinaâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚<â”€â”€Instruccionesâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚
  â”‚   Ejercicio 1â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚â”€â”€Completar Ejercicioâ”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚<â”€â”€Siguiente Ejercicioâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚â”€â”€Completar Rutinaâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚â”€â”€UPDATEâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚  Patient       â”‚
  â”‚              â”‚               â”‚  (progreso,    â”‚
  â”‚              â”‚               â”‚   sesiones)    â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚<â”€â”€Successâ”€â”€â”€â”€â”€â”€â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚<â”€â”€ConfirmaciÃ³nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚
  â”‚   "Rutina completada"         â”‚                â”‚
```

---

## 6. CAPTURAR Y COMPARTIR VIDEO (PACIENTE)

```
Paciente    Sistema Web    Flask Routes    Base de Datos    Sistema Archivos
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚â”€â”€GET /patient/start-therapyâ”€â”€>â”‚              â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚<â”€â”€PÃ¡gina Terapiaâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚                 â”‚
  â”‚   (con cÃ¡mara)â”‚               â”‚                â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚â”€â”€Iniciar CÃ¡maraâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚<â”€â”€Stream Videoâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚â”€â”€Grabar Videoâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚                 â”‚
  â”‚  (iniciar)  â”‚               â”‚                â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚<â”€â”€Grabando...â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚â”€â”€Detener GrabaciÃ³nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚                 â”‚
  â”‚  (video blob, notas)            â”‚                â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚             â”‚â”€â”€save_patient_video()â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚             â”‚               â”‚â”€â”€Save Fileâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚             â”‚               â”‚  (static/uploads/videos/)        â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚             â”‚               â”‚<â”€â”€File Pathâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚             â”‚               â”‚â”€â”€INSERTâ”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
  â”‚             â”‚               â”‚  SessionCaptureâ”‚                 â”‚
  â”‚             â”‚               â”‚  (id_paciente, â”‚                 â”‚
  â”‚             â”‚               â”‚   tipo: video) â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚             â”‚               â”‚<â”€â”€capture_idâ”€â”€â”€â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚<â”€â”€ConfirmaciÃ³nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚                 â”‚
  â”‚   "Video guardado"             â”‚                â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚â”€â”€GET /patient/video-galleryâ”€â”€â”€>â”‚                â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚             â”‚â”€â”€get_patient_captures()â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚             â”‚               â”‚â”€â”€Queryâ”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
  â”‚             â”‚               â”‚  SessionCaptureâ”‚                 â”‚
  â”‚             â”‚               â”‚  (id_paciente) â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚             â”‚               â”‚<â”€â”€Capturesâ”€â”€â”€â”€â”€â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚<â”€â”€GalerÃ­a Videosâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚â”€â”€Compartir Video con Terapeuta>â”‚                â”‚                 â”‚
  â”‚  (capture_id, therapist_id,    â”‚                â”‚                 â”‚
  â”‚   mensaje)  â”‚               â”‚                â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚             â”‚â”€â”€patient_share_video()â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚             â”‚               â”‚â”€â”€Verifyâ”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
  â”‚             â”‚               â”‚  Capture       â”‚                 â”‚
  â”‚             â”‚               â”‚  Ownership     â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚             â”‚               â”‚â”€â”€Verifyâ”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
  â”‚             â”‚               â”‚  Therapist     â”‚                 â”‚
  â”‚             â”‚               â”‚  Assignment    â”‚                 â”‚
  â”‚             â”‚               â”‚  (via Routine) â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚             â”‚               â”‚â”€â”€INSERTâ”€â”€â”€â”€â”€â”€â”€â”€>â”‚                 â”‚
  â”‚             â”‚               â”‚  VideoShare    â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚             â”‚               â”‚<â”€â”€share_idâ”€â”€â”€â”€â”€â”‚                 â”‚
  â”‚             â”‚               â”‚                â”‚                 â”‚
  â”‚<â”€â”€ConfirmaciÃ³nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚                 â”‚
  â”‚   "Video compartido"           â”‚                â”‚                 â”‚
```

---

## 7. GESTIONAR USUARIOS (ADMINISTRADOR)

```
Admin        Sistema Web    Flask Routes    Base de Datos
  â”‚              â”‚               â”‚                â”‚
  â”‚â”€â”€GET /admin/usersâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚â”€â”€admin_users()â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚â”€â”€Query Allâ”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚  Users         â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚<â”€â”€Users Listâ”€â”€â”€â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚<â”€â”€Lista Usuariosâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚â”€â”€Agregar Terapeutaâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚
  â”‚  (nombre, usuario, email,     â”‚                â”‚
  â”‚   password, especialidad)     â”‚                â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚â”€â”€add_therapist()â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚â”€â”€Validateâ”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚  Username      â”‚
  â”‚              â”‚               â”‚  Email         â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚â”€â”€INSERTâ”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚  User          â”‚
  â”‚              â”‚               â”‚  (rol:         â”‚
  â”‚              â”‚               â”‚   therapist)   â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚<â”€â”€user_idâ”€â”€â”€â”€â”€â”€â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚â”€â”€INSERTâ”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚  Therapist     â”‚
  â”‚              â”‚               â”‚  (id_usuario,  â”‚
  â”‚              â”‚               â”‚   especialidad)â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚<â”€â”€Successâ”€â”€â”€â”€â”€â”€â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚<â”€â”€ConfirmaciÃ³nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚
  â”‚   "Terapeuta creado"          â”‚                â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚â”€â”€Agregar Pacienteâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚
  â”‚  (nombre, usuario, email,     â”‚                â”‚
  â”‚   password, diagnÃ³stico)      â”‚                â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚â”€â”€add_patient()â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚â”€â”€Validateâ”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚  Username      â”‚
  â”‚              â”‚               â”‚  Email         â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚â”€â”€INSERTâ”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚  User          â”‚
  â”‚              â”‚               â”‚  (rol: patient)â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚<â”€â”€user_idâ”€â”€â”€â”€â”€â”€â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚â”€â”€INSERTâ”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚  Patient       â”‚
  â”‚              â”‚               â”‚  (id_usuario,  â”‚
  â”‚              â”‚               â”‚   diagnÃ³stico) â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚<â”€â”€Successâ”€â”€â”€â”€â”€â”€â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚<â”€â”€ConfirmaciÃ³nâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚
  â”‚   "Paciente creado"           â”‚                â”‚
```


---

## 8. CONFIGURAR SISTEMA (ADMINISTRADOR)

```
Admin        Sistema Web    Flask Routes    Base de Datos
  â”‚              â”‚               â”‚                â”‚
  â”‚â”€â”€GET /admin/settingsâ”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚â”€â”€admin_settings()â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚â”€â”€Query Allâ”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚  SystemSettingsâ”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚<â”€â”€Settingsâ”€â”€â”€â”€â”€â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚<â”€â”€PÃ¡gina ConfiguraciÃ³nâ”€â”€â”€â”€â”€â”€â”€â”€â”‚                â”‚
  â”‚   (formularios)â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚â”€â”€Actualizar ConfiguraciÃ³nâ”€â”€â”€â”€>â”‚                â”‚
  â”‚  (setting_type: session_      â”‚                â”‚
  â”‚   duration, valores)           â”‚                â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚â”€â”€POST admin_settings()â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
  â”‚              â”‚               â”‚                â”‚
  â”‚              â”‚               â”‚â”€â”€UPDATE/INSER